{"ast":null,"code":"/**\n * Module dependencies.\n */\n\nvar Emitter = require('events').EventEmitter;\nvar parser = require('socket.io-parser');\nvar url = require('url');\nvar debug = require('debug')('socket.io:socket');\nvar hasBin = require('has-binary');\nvar assign = require('object-assign');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Blacklisted events.\n *\n * @api public\n */\n\nexports.events = ['error', 'connect', 'disconnect', 'disconnecting', 'newListener', 'removeListener'];\n\n/**\n * Flags.\n *\n * @api private\n */\n\nvar flags = ['json', 'volatile', 'broadcast'];\n\n/**\n * `EventEmitter#emit` reference.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * Interface to a `Client` for a given `Namespace`.\n *\n * @param {Namespace} nsp\n * @param {Client} client\n * @api public\n */\n\nfunction Socket(nsp, client, query) {\n  this.nsp = nsp;\n  this.server = nsp.server;\n  this.adapter = this.nsp.adapter;\n  this.id = nsp.name !== '/' ? nsp.name + '#' + client.id : client.id;\n  this.client = client;\n  this.conn = client.conn;\n  this.rooms = {};\n  this.acks = {};\n  this.connected = true;\n  this.disconnected = false;\n  this.handshake = this.buildHandshake(query);\n  this.fns = [];\n}\n\n/**\n * Inherits from `EventEmitter`.\n */\n\nSocket.prototype.__proto__ = Emitter.prototype;\n\n/**\n * Apply flags from `Socket`.\n */\n\nflags.forEach(function (flag) {\n  Object.defineProperty(Socket.prototype, flag, {\n    get: function () {\n      this.flags = this.flags || {};\n      this.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * `request` engine.io shortcut.\n *\n * @api public\n */\n\nObject.defineProperty(Socket.prototype, 'request', {\n  get: function () {\n    return this.conn.request;\n  }\n});\n\n/**\n * Builds the `handshake` BC object\n *\n * @api private\n */\n\nSocket.prototype.buildHandshake = function (query) {\n  var self = this;\n  function buildQuery() {\n    var requestQuery = url.parse(self.request.url, true).query;\n    //if socket-specific query exist, replace query strings in requestQuery\n    return assign({}, query, requestQuery);\n  }\n  return {\n    headers: this.request.headers,\n    time: new Date() + '',\n    address: this.conn.remoteAddress,\n    xdomain: !!this.request.headers.origin,\n    secure: !!this.request.connection.encrypted,\n    issued: +new Date(),\n    url: this.request.url,\n    query: buildQuery()\n  };\n};\n\n/**\n * Emits to this client.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (~exports.events.indexOf(ev)) {\n    emit.apply(this, arguments);\n  } else {\n    var args = Array.prototype.slice.call(arguments);\n    var packet = {};\n    packet.type = hasBin(args) ? parser.BINARY_EVENT : parser.EVENT;\n    packet.data = args;\n    var flags = this.flags || {};\n\n    // access last argument to see if it's an ACK callback\n    if ('function' == typeof args[args.length - 1]) {\n      if (this._rooms || flags.broadcast) {\n        throw new Error('Callbacks are not supported when broadcasting');\n      }\n      debug('emitting packet with ack id %d', this.nsp.ids);\n      this.acks[this.nsp.ids] = args.pop();\n      packet.id = this.nsp.ids++;\n    }\n    if (this._rooms || flags.broadcast) {\n      this.adapter.broadcast(packet, {\n        except: [this.id],\n        rooms: this._rooms,\n        flags: flags\n      });\n    } else {\n      // dispatch packet\n      this.packet(packet, {\n        volatile: flags.volatile,\n        compress: flags.compress\n      });\n    }\n\n    // reset flags\n    delete this._rooms;\n    delete this.flags;\n  }\n  return this;\n};\n\n/**\n * Targets a room when broadcasting.\n *\n * @param {String} name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.to = Socket.prototype.in = function (name) {\n  this._rooms = this._rooms || [];\n  if (!~this._rooms.indexOf(name)) this._rooms.push(name);\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = Socket.prototype.write = function () {\n  var args = Array.prototype.slice.call(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet object\n * @param {Object} opts options\n * @api private\n */\n\nSocket.prototype.packet = function (packet, opts) {\n  packet.nsp = this.nsp.name;\n  opts = opts || {};\n  opts.compress = false !== opts.compress;\n  this.client.packet(packet, opts);\n};\n\n/**\n * Joins a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.join = function (room, fn) {\n  debug('joining room %s', room);\n  var self = this;\n  if (this.rooms.hasOwnProperty(room)) {\n    fn && fn(null);\n    return this;\n  }\n  this.adapter.add(this.id, room, function (err) {\n    if (err) return fn && fn(err);\n    debug('joined room %s', room);\n    self.rooms[room] = room;\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leaves a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.leave = function (room, fn) {\n  debug('leave room %s', room);\n  var self = this;\n  this.adapter.del(this.id, room, function (err) {\n    if (err) return fn && fn(err);\n    debug('left room %s', room);\n    delete self.rooms[room];\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leave all rooms.\n *\n * @api private\n */\n\nSocket.prototype.leaveAll = function () {\n  this.adapter.delAll(this.id);\n  this.rooms = {};\n};\n\n/**\n * Called by `Namespace` upon successful\n * middleware execution (ie: authorization).\n * Socket is added to namespace array before\n * call to join, so adapters can access it.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  debug('socket connected - writing packet');\n  this.nsp.connected[this.id] = this;\n  this.join(this.id);\n  this.packet({\n    type: parser.CONNECT\n  });\n};\n\n/**\n * Called with each packet. Called by `Client`.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  debug('got packet %j', packet);\n  switch (packet.type) {\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n    case parser.ACK:\n      this.onack(packet);\n      break;\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n    case parser.ERROR:\n      this.emit('error', packet.data);\n  }\n};\n\n/**\n * Called upon event packet.\n *\n * @param {Object} packet object\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n  this.dispatch(args);\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @param {Number} id packet id\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    var args = Array.prototype.slice.call(arguments);\n    debug('sending ack %j', args);\n    var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;\n    self.packet({\n      id: id,\n      type: type,\n      data: args\n    });\n    sent = true;\n  };\n};\n\n/**\n * Called upon ack packet.\n *\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' == typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon client disconnect packet.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('got disconnect packet');\n  this.onclose('client namespace disconnect');\n};\n\n/**\n * Handles a client error.\n *\n * @api private\n */\n\nSocket.prototype.onerror = function (err) {\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else {\n    console.error('Missing error handler on `socket`.');\n    console.error(err.stack);\n  }\n};\n\n/**\n * Called upon closing. Called by `Client`.\n *\n * @param {String} reason\n * @throw {Error} optional error object\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  if (!this.connected) return this;\n  debug('closing socket - reason %s', reason);\n  this.emit('disconnecting', reason);\n  this.leaveAll();\n  this.nsp.remove(this);\n  this.client.remove(this);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.nsp.connected[this.id];\n  this.emit('disconnect', reason);\n};\n\n/**\n * Produces an `error` packet.\n *\n * @param {Object} err error object\n * @api private\n */\n\nSocket.prototype.error = function (err) {\n  this.packet({\n    type: parser.ERROR,\n    data: err\n  });\n};\n\n/**\n * Disconnects this client.\n *\n * @param {Boolean} close if `true`, closes the underlying connection\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.disconnect = function (close) {\n  if (!this.connected) return this;\n  if (close) {\n    this.client.disconnect();\n  } else {\n    this.packet({\n      type: parser.DISCONNECT\n    });\n    this.onclose('server namespace disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} compress if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags = this.flags || {};\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Dispatch incoming event to socket listeners.\n *\n * @param {Array} event that will get emitted\n * @api private\n */\n\nSocket.prototype.dispatch = function (event) {\n  debug('dispatching an event %j', event);\n  var self = this;\n  this.run(event, function (err) {\n    process.nextTick(function () {\n      if (err) {\n        return self.error(err.data || err.message);\n      }\n      emit.apply(self, event);\n    });\n  });\n};\n\n/**\n * Sets up socket middleware.\n *\n * @param {Function} middleware function (event, next)\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.use = function (fn) {\n  this.fns.push(fn);\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming event.\n *\n * @param {Array} event that will get emitted\n * @param {Function} last fn call in the middleware\n * @api private\n */\nSocket.prototype.run = function (event, fn) {\n  var fns = this.fns.slice(0);\n  if (!fns.length) return fn(null);\n  function run(i) {\n    fns[i](event, function (err) {\n      // upon error, short-circuit\n      if (err) return fn(err);\n\n      // if no middleware left, summon callback\n      if (!fns[i + 1]) return fn(null);\n\n      // go on to next\n      run(i + 1);\n    });\n  }\n  run(0);\n};","map":{"version":3,"names":["Emitter","require","EventEmitter","parser","url","debug","hasBin","assign","module","exports","Socket","events","flags","emit","prototype","nsp","client","query","server","adapter","id","name","conn","rooms","acks","connected","disconnected","handshake","buildHandshake","fns","__proto__","forEach","flag","Object","defineProperty","get","request","self","buildQuery","requestQuery","parse","headers","time","Date","address","remoteAddress","xdomain","origin","secure","connection","encrypted","issued","ev","indexOf","apply","arguments","args","Array","slice","call","packet","type","BINARY_EVENT","EVENT","data","length","_rooms","broadcast","Error","ids","pop","except","volatile","compress","to","in","push","send","write","unshift","opts","join","room","fn","hasOwnProperty","add","err","leave","del","leaveAll","delAll","onconnect","CONNECT","onpacket","onevent","ACK","onack","BINARY_ACK","DISCONNECT","ondisconnect","ERROR","ack","dispatch","sent","onclose","onerror","listeners","console","error","stack","reason","remove","disconnect","close","event","run","process","nextTick","message","use","i"],"sources":["C:/Users/walle/Documents/lummelundalogin/lummelundalogin/node_modules/socket.io/lib/socket.js"],"sourcesContent":["\n/**\n * Module dependencies.\n */\n\nvar Emitter = require('events').EventEmitter;\nvar parser = require('socket.io-parser');\nvar url = require('url');\nvar debug = require('debug')('socket.io:socket');\nvar hasBin = require('has-binary');\nvar assign = require('object-assign');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Blacklisted events.\n *\n * @api public\n */\n\nexports.events = [\n  'error',\n  'connect',\n  'disconnect',\n  'disconnecting',\n  'newListener',\n  'removeListener'\n];\n\n/**\n * Flags.\n *\n * @api private\n */\n\nvar flags = [\n  'json',\n  'volatile',\n  'broadcast'\n];\n\n/**\n * `EventEmitter#emit` reference.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * Interface to a `Client` for a given `Namespace`.\n *\n * @param {Namespace} nsp\n * @param {Client} client\n * @api public\n */\n\nfunction Socket(nsp, client, query){\n  this.nsp = nsp;\n  this.server = nsp.server;\n  this.adapter = this.nsp.adapter;\n  this.id = nsp.name !== '/' ? nsp.name + '#' + client.id : client.id;\n  this.client = client;\n  this.conn = client.conn;\n  this.rooms = {};\n  this.acks = {};\n  this.connected = true;\n  this.disconnected = false;\n  this.handshake = this.buildHandshake(query);\n  this.fns = [];\n}\n\n/**\n * Inherits from `EventEmitter`.\n */\n\nSocket.prototype.__proto__ = Emitter.prototype;\n\n/**\n * Apply flags from `Socket`.\n */\n\nflags.forEach(function(flag){\n  Object.defineProperty(Socket.prototype, flag, {\n    get: function() {\n      this.flags = this.flags || {};\n      this.flags[flag] = true;\n      return this;\n    }\n  });\n});\n\n/**\n * `request` engine.io shortcut.\n *\n * @api public\n */\n\nObject.defineProperty(Socket.prototype, 'request', {\n  get: function() {\n    return this.conn.request;\n  }\n});\n\n/**\n * Builds the `handshake` BC object\n *\n * @api private\n */\n\nSocket.prototype.buildHandshake = function(query){\n  var self = this;\n  function buildQuery(){\n    var requestQuery = url.parse(self.request.url, true).query;\n    //if socket-specific query exist, replace query strings in requestQuery\n    return assign({}, query, requestQuery);\n  }\n  return {\n    headers: this.request.headers,\n    time: (new Date) + '',\n    address: this.conn.remoteAddress,\n    xdomain: !!this.request.headers.origin,\n    secure: !!this.request.connection.encrypted,\n    issued: +(new Date),\n    url: this.request.url,\n    query: buildQuery()\n  };\n};\n\n/**\n * Emits to this client.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function(ev){\n  if (~exports.events.indexOf(ev)) {\n    emit.apply(this, arguments);\n  } else {\n    var args = Array.prototype.slice.call(arguments);\n    var packet = {};\n    packet.type = hasBin(args) ? parser.BINARY_EVENT : parser.EVENT;\n    packet.data = args;\n    var flags = this.flags || {};\n\n    // access last argument to see if it's an ACK callback\n    if ('function' == typeof args[args.length - 1]) {\n      if (this._rooms || flags.broadcast) {\n        throw new Error('Callbacks are not supported when broadcasting');\n      }\n\n      debug('emitting packet with ack id %d', this.nsp.ids);\n      this.acks[this.nsp.ids] = args.pop();\n      packet.id = this.nsp.ids++;\n    }\n\n    if (this._rooms || flags.broadcast) {\n      this.adapter.broadcast(packet, {\n        except: [this.id],\n        rooms: this._rooms,\n        flags: flags\n      });\n    } else {\n      // dispatch packet\n      this.packet(packet, {\n        volatile: flags.volatile,\n        compress: flags.compress\n      });\n    }\n\n    // reset flags\n    delete this._rooms;\n    delete this.flags;\n  }\n  return this;\n};\n\n/**\n * Targets a room when broadcasting.\n *\n * @param {String} name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.to =\nSocket.prototype.in = function(name){\n  this._rooms = this._rooms || [];\n  if (!~this._rooms.indexOf(name)) this._rooms.push(name);\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send =\nSocket.prototype.write = function(){\n  var args = Array.prototype.slice.call(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet object\n * @param {Object} opts options\n * @api private\n */\n\nSocket.prototype.packet = function(packet, opts){\n  packet.nsp = this.nsp.name;\n  opts = opts || {};\n  opts.compress = false !== opts.compress;\n  this.client.packet(packet, opts);\n};\n\n/**\n * Joins a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.join = function(room, fn){\n  debug('joining room %s', room);\n  var self = this;\n  if (this.rooms.hasOwnProperty(room)) {\n    fn && fn(null);\n    return this;\n  }\n  this.adapter.add(this.id, room, function(err){\n    if (err) return fn && fn(err);\n    debug('joined room %s', room);\n    self.rooms[room] = room;\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leaves a room.\n *\n * @param {String} room\n * @param {Function} fn optional, callback\n * @return {Socket} self\n * @api private\n */\n\nSocket.prototype.leave = function(room, fn){\n  debug('leave room %s', room);\n  var self = this;\n  this.adapter.del(this.id, room, function(err){\n    if (err) return fn && fn(err);\n    debug('left room %s', room);\n    delete self.rooms[room];\n    fn && fn(null);\n  });\n  return this;\n};\n\n/**\n * Leave all rooms.\n *\n * @api private\n */\n\nSocket.prototype.leaveAll = function(){\n  this.adapter.delAll(this.id);\n  this.rooms = {};\n};\n\n/**\n * Called by `Namespace` upon successful\n * middleware execution (ie: authorization).\n * Socket is added to namespace array before\n * call to join, so adapters can access it.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function(){\n  debug('socket connected - writing packet');\n  this.nsp.connected[this.id] = this;\n  this.join(this.id);\n  this.packet({ type: parser.CONNECT });\n};\n\n/**\n * Called with each packet. Called by `Client`.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function(packet){\n  debug('got packet %j', packet);\n  switch (packet.type) {\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n  }\n};\n\n/**\n * Called upon event packet.\n *\n * @param {Object} packet object\n * @api private\n */\n\nSocket.prototype.onevent = function(packet){\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  this.dispatch(args);\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @param {Number} id packet id\n * @api private\n */\n\nSocket.prototype.ack = function(id){\n  var self = this;\n  var sent = false;\n  return function(){\n    // prevent double callbacks\n    if (sent) return;\n    var args = Array.prototype.slice.call(arguments);\n    debug('sending ack %j', args);\n\n    var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;\n    self.packet({\n      id: id,\n      type: type,\n      data: args\n    });\n\n    sent = true;\n  };\n};\n\n/**\n * Called upon ack packet.\n *\n * @api private\n */\n\nSocket.prototype.onack = function(packet){\n  var ack = this.acks[packet.id];\n  if ('function' == typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon client disconnect packet.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function(){\n  debug('got disconnect packet');\n  this.onclose('client namespace disconnect');\n};\n\n/**\n * Handles a client error.\n *\n * @api private\n */\n\nSocket.prototype.onerror = function(err){\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else {\n    console.error('Missing error handler on `socket`.');\n    console.error(err.stack);\n  }\n};\n\n/**\n * Called upon closing. Called by `Client`.\n *\n * @param {String} reason\n * @throw {Error} optional error object\n * @api private\n */\n\nSocket.prototype.onclose = function(reason){\n  if (!this.connected) return this;\n  debug('closing socket - reason %s', reason);\n  this.emit('disconnecting', reason);\n  this.leaveAll();\n  this.nsp.remove(this);\n  this.client.remove(this);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.nsp.connected[this.id];\n  this.emit('disconnect', reason);\n};\n\n/**\n * Produces an `error` packet.\n *\n * @param {Object} err error object\n * @api private\n */\n\nSocket.prototype.error = function(err){\n  this.packet({ type: parser.ERROR, data: err });\n};\n\n/**\n * Disconnects this client.\n *\n * @param {Boolean} close if `true`, closes the underlying connection\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.disconnect = function(close){\n  if (!this.connected) return this;\n  if (close) {\n    this.client.disconnect();\n  } else {\n    this.packet({ type: parser.DISCONNECT });\n    this.onclose('server namespace disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} compress if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function(compress){\n  this.flags = this.flags || {};\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Dispatch incoming event to socket listeners.\n *\n * @param {Array} event that will get emitted\n * @api private\n */\n\nSocket.prototype.dispatch = function(event){\n  debug('dispatching an event %j', event);\n  var self = this;\n  this.run(event, function(err){\n    process.nextTick(function(){\n      if (err) {\n        return self.error(err.data || err.message);\n      }\n      emit.apply(self, event);\n    });\n  });\n}\n\n/**\n * Sets up socket middleware.\n *\n * @param {Function} middleware function (event, next)\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.use = function(fn){\n  this.fns.push(fn);\n  return this;\n};\n\n/**\n * Executes the middleware for an incoming event.\n *\n * @param {Array} event that will get emitted\n * @param {Function} last fn call in the middleware\n * @api private\n */\nSocket.prototype.run = function(event, fn){\n  var fns = this.fns.slice(0);\n  if (!fns.length) return fn(null);\n\n  function run(i){\n    fns[i](event, function(err){\n      // upon error, short-circuit\n      if (err) return fn(err);\n\n      // if no middleware left, summon callback\n      if (!fns[i + 1]) return fn(null);\n\n      // go on to next\n      run(i + 1);\n    });\n  }\n\n  run(0);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}